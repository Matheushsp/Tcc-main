<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ERP - Produtos</title>
  <style>
    body{font-family:Arial;background:#111;color:#eee;padding:20px}
    button{padding:10px;border:0;background:#0f0;color:#000;margin-bottom:20px;cursor:pointer}
    .product-card{background:#222;padding:10px;margin-bottom:8px;border:1px solid #333}
  </style>
</head>
<body>

<h2>Produtos</h2>

<button onclick="adicionarProdutoFixo()">Adicionar Produto Fixo</button>

<div id="produtos"></div>

<script>
const API = "https://tcc-uh9r.onrender.com"; // seu backend

// carregar produtos
async function carregarProdutos(){
  const container = document.getElementById("produtos");
  container.innerHTML = "Carregando...";

  try{
    const res = await fetch(`${API}/api/produtos`);
    if(!res.ok) throw new Error("Erro no GET");
    const produtos = await res.json();

    if(!produtos.length){
      container.innerHTML = "<p>Nenhum produto encontrado</p>";
      return;
    }

    container.innerHTML = produtos.map(p=>`
      <div class="product-card">
        <strong>${p.nome}</strong><br>
        Pre√ßo: R$ ${Number(p.preco).toFixed(2)}<br>
        ${p.mais_vendido ? "<em>Mais vendido</em>" : ""}
      </div>
    `).join("");

  }catch(err){
    container.innerHTML = "<p>Erro ao carregar</p>";
    console.error(err);
  }
}

// adicionar fixo
async function adicionarProdutoFixo(){
  try{
    const res = await fetch(`${API}/api/produtos`,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        nome:"Cookie Chocolate",
        preco:9.90,
        mais_vendido:true
      })
    });
    if(!res.ok) throw new Error("Erro ao adicionar produto");

    await carregarProdutos();
  }catch(err){
    console.error(err);
    alert("Erro ao adicionar");
  }
}

carregarProdutos();
</script>

</body>
</html>
